const int CLOUDS_FLAGS = SXF_CLIENTSIDE | SXF_TRANSFERSCALE | SXF_TRANSFERRENDERSTYLE | SXF_TRANSFERSTENCILCOL;

ACTOR CloudSpawner
{
	//$Category Special Effects (BoA)
	//$Title Cloudstorm Spawner (arg1 xRadius, arg2 zRadius, arg3 Chance, arg4 Size, arg5 Color; Renderstyle, Stencilcolor and Scale are taken into account)
	//$Color 12
	//$Arg0 "Radius(x/y)"
	//$Arg0Tooltip "Radius of spawn area in map units"
	//$Arg1 "Height(z)"
	//$Arg1Tooltip "Height of spawn area in map units"
	//$Arg2 "Frequency"
	//$Arg2Tooltip "0 is always, 255 is never at a 30-tic basis"
	//$Arg3 "Size"
	//$Arg3Type 11
	//$Arg3Enum { 0 = "Small"; 1 = "Medium"; 2 = "Large"; }
	//$Arg4 "Color"
	//$Arg4Type 11
	//$Arg4Enum { 0 = "Grey (slow)"; 1 = "Tan (slow)"; 2 = "Dark (fast)"; }
	+CLIENTSIDEONLY
	+NOBLOCKMAP
	+NOCLIP
	+NOGRAVITY
	+NOINTERACTION
	+NOSECTOR
	States
	{
	Spawn:
		TNT1 A 0 NODELAY A_JumpIf(CallACS("CloudSwitch")==0,"EndSpawn")
		TNT1 A 0 A_JumpIf(Args[4] == 1, "Tan")
		TNT1 A 0 A_JumpIf(Args[4] == 2, "Dark")
	Grey:
		TNT1 A 0 A_JumpIf(Args[3] == 0, "SmallGrey")
		TNT1 A 0 A_JumpIf(Args[3] == 1, "MediumGrey")
		TNT1 A 0 A_JumpIf(Args[3] > 1, "LargeGrey")
		Goto SmallGrey
	Tan:
		TNT1 A 0 A_JumpIf(Args[3] == 0, "SmallTan")
		TNT1 A 0 A_JumpIf(Args[3] == 1, "MediumTan")
		TNT1 A 0 A_JumpIf(Args[3] > 1, "LargeTan")
		Goto SmallTan
	Dark:
		TNT1 A 0 A_JumpIf(Args[3] == 0, "SmallDark")
		TNT1 A 0 A_JumpIf(Args[3] == 1, "MediumDark")
		TNT1 A 0 A_JumpIf(Args[3] > 1, "LargeDark")
		Goto SmallDark
	SmallGrey:
		TNT1 A 30 A_SpawnItemEx("SmallCloudGrey", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(5.0, 8.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	MediumGrey:
		TNT1 A 30 A_SpawnItemEx("MediumCloudGrey", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(5.0, 8.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	LargeGrey:
		TNT1 A 30 A_SpawnItemEx("LargeCloudGrey", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(5.0, 8.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	SmallTan:
		TNT1 A 30 A_SpawnItemEx("SmallCloudTan", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(5.0, 8.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	MediumTan:
		TNT1 A 30 A_SpawnItemEx("MediumCloudTan", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(5.0, 8.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	LargeTan:
		TNT1 A 30 A_SpawnItemEx("LargeCloudTan", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(5.0, 8.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	SmallDark:
		TNT1 A 30 A_SpawnItemEx("SmallCloudDark", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(40.0, 70.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	MediumDark:
		TNT1 A 30 A_SpawnItemEx("MediumCloudDark", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(40.0, 70.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	LargeDark:
		TNT1 A 30 A_SpawnItemEx("LargeCloudDark", random(Args[0]*2, -Args[0]*2), random(Args[0]*2, -Args[0]*2), random(0, Args[1]), frandom(40.0, 70.0), 0, 0, random(6, -6), CLOUDS_FLAGS, Args[2])
		Loop
	EndSpawn:
		TNT1 A 1
		Stop
	}
}

//Base Cloud Grey
ACTOR CloudBaseGrey
{
	+MISSILE
	+NOBLOCKMAP
	+NOGRAVITY
	Radius 1
	Height 1
	RenderStyle "Translucent"
	Alpha 0.1
	Scale 0.5
	States
	{
	Spawn:
		TNT1 A 0 NODELAY A_Jump(256, "Cloud1", "Cloud2")
	Cloud1:
		CLXG A 0
		Goto Movement
	Cloud2:
		CLXG B 0
		Goto Movement
	Movement:
		"####""###########" 3 A_FadeIn(0.05)
		"####" "#" 1000
		Wait
	Death:
		"####" "#" 5 A_FadeOut(0.05,FTF_REMOVE)
		Loop
	}
}

ACTOR SmallCloudGrey : CloudBaseGrey  {	Scale 1.0 }
ACTOR MediumCloudGrey : CloudBaseGrey {	Scale 2.0 }
ACTOR LargeCloudGrey : CloudBaseGrey  {	Scale 4.0 }


//Base Cloud Tan
ACTOR CloudBaseTan : CloudBaseGrey
{
	States
	{
	Spawn:
		TNT1 A 0 NODELAY A_Jump(256, "Cloud1", "Cloud2")
	Cloud1:
		CLXT A 0
		Goto Movement
	Cloud2:
		CLXT B 0
		Goto Movement
	}
}

//Grey Clouds
ACTOR SmallCloudTan : CloudBaseTan  {	Scale 1.0 }
ACTOR MediumCloudTan : CloudBaseTan {	Scale 2.0 }
ACTOR LargeCloudTan : CloudBaseTan  {	Scale 4.0 }

//Base Cloud Dark
ACTOR CloudBaseDark : CloudBaseGrey
{
	States
	{
	Spawn:
		TNT1 A 0 NODELAY A_Jump(256, "Cloud1", "Cloud2")
	Cloud1:
		CLXD A 0
		Goto Movement
	Cloud2:
		CLXD B 0
		Goto Movement
	}
}

//Grey Clouds
ACTOR SmallCloudDark : CloudBaseDark  {	Scale 1.0 }
ACTOR MediumCloudDark : CloudBaseDark {	Scale 2.0 }
ACTOR LargeCloudDark : CloudBaseDark  {	Scale 4.0 }